suite: test directus deployment
templates:
  - deployment.yaml
tests:
  - it: should be a Deployment
    set:
      image.pullPolicy: Always
      resources:
        limits:
          memory: 128Mi
    release:
      name: my-release
    asserts:
      - isKind:
          of: Deployment
      - equal:
          path: metadata.name
          value: my-release-directus

  - it: should have an annotations, default and custom.
    set:
      podAnnotations:
        test/foo: "bar"
    asserts:
      - equal:
          path: spec.template.metadata.annotations["seccomp.security.alpha.kubernetes.io/pod"]
          value: "runtime/default"
      - equal:
          path: spec.template.metadata.annotations["test/foo"]
          value: "bar"
